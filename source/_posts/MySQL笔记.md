---
title: MySQL笔记
date: 2018-09-12 23:57:23
tags:
---
在Mysql的InnoDB中，有两种类型的B+树索引，一种称为聚簇索引，一种称为二级索引。

聚簇索引

索引和数据存储在一块（ 都存储在同一个B*tree 中）。 
一般主键索引都是聚餐索引

Mysql中InnoDB引擎的主键索引为聚簇索引，MyISAM存储引擎采用非聚集索引
非聚簇索引

索引数据和存储数据是分离的。

二级索引（辅助索引）

二级索引存储的是记录的主键，而不是数据存储的地址。
以Mysql的InnoDB为例 
主键是聚集索引 
唯一索引、普通索引、前缀索引等都是二级索引（辅助索引）

innodb数据表文件：

从物理意义上来讲，InnoDB表由共享表空间、日志文件组（redo文件组）、表结构定义文件组成。若将innodb_file_per_table设置为on，则系统将为每一个表单独的生成一个table_name.ibd的文件（独占表空间），在此文件中，存储与该表相关的数据、索引、表的内部数据字典信息。表结构文件则以.frm结尾，这与存储引擎无关。
如：user.ibd，user.frm

MyISAM数据库表文件：

MyISAM表是独立于操作系统的，这说明可以轻松地将其从Windows服务器移植到Linux服务器；每当我们建立一个MyISAM引擎的表时，就会在本地磁盘上建立三个文件，文件名就是表明。例如，我建立了一个MyISAM引擎的test表，那么就会生成以下三个文件：

test.frm，存储表定义；
test.MYD，存储数据；
test.MYI，存储索引。

innodb事务隔离

mysql的四种隔离级别：
未提交读、已提交读，可重复读（默认），可序列换

InnoDB的行锁模式及加锁方法

(一).行锁模式

1.共享锁(S锁):

对同一行数据都可以共享一把锁,但是没有获得锁的事务只可以读,不可以修改

2.排它锁(X锁)

对同一行数据,获得该锁的事务可读可写,未获得锁的事务不可读也不可写.

 

另外，为了允许行锁和表锁共存，实现多粒度锁机制，InnoDB还有两种内部使用的意向锁（Intention Locks），这两种意向锁都是表锁。

3.意向共享锁（IS）：事务打算给数据行加行共享锁，事务在给一个数据行加共享锁前必须先取得该表的IS锁。

4.意向排他锁（IX）：事务打算给数据行加行排他锁，事务在给一个数据行加排他锁前必须先取得该表的IX锁。
